/*
 * PRESENT.c
 *
 * Created: 2020-04-19 오전 11:42:21
 * Author : info
 */ 

#include <avr/io.h>

typedef unsigned char u8;
typedef unsigned short u16;
typedef unsigned int u32;

//#define NUM_ROUND 31
#define TEXT_SIZE 8


u16 pre_compute[16*4] __attribute__((aligned(256)))= { 0,};

//u16 rk[NUM_ROUND]={0,};
u16 rk[32*4]={0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
	0x3FFF, 0xFFFF, 0x3FFF, 0x3FFF,
	0xFFFF, 0xFFFF, 0xFFFF, 0x2DFF,
	0x9FFF, 0x1FFF, 0x4FFF, 0x3FFF,
	0xFFFE, 0xFFFF, 0xFFFF, 0x19B7,
	0xA7FE, 0x9FFF, 0xE7FF, 0x07FF,
	0xFFFE, 0xFFFF, 0xDFFF, 0x7966,
	0x73FE, 0x43FF, 0xE9FF, 0x27FF,
	0xFFFD, 0xFFFF, 0x9B7F, 0x40E5,
	0x74FF, 0x53FE, 0x5CFF, 0x90FF,
	0xFFFD, 0xFFFF, 0x966D, 0x8003,
	0xEE7F, 0x887E, 0x9D3F, 0x94FF,
	0xFFFC, 0xB7FF, 0x0E59, 0xFA00,
	0x0E9E, 0xCA7E, 0xBB9F, 0xA21F,
	0xFFFC, 0x66DF, 0x0039, 0xEDE8,
	0x9DCE, 0xD10E, 0x03A7, 0x329F,
	0x7FFB, 0xE59B, 0xA000, 0x3DB7,
	0x81D3, 0x194F, 0xE772, 0xB443,
	0x6DFB, 0x0396, 0xDE80, 0xD9F6,
	0x33B9, 0xDA21, 0x2075, 0x8653,
	0x59B2, 0x000E, 0xDB7A, 0x1D67,
	0x503B, 0x0329, 0x0CEF, 0x3688,
	0x3963, 0xE800, 0x9F6D, 0x1475,
	0x4676, 0xDB44, 0x140F, 0x80CA,
	0x00E3, 0xB7A0, 0xD67D, 0xEC51,
	0x8A07, 0x4064, 0xD19C, 0xB6D1,
	0x8005, 0xF6DE, 0x4759, 0x6BB1,
	0xE8CE, 0xDB69, 0xA280, 0xD019,
	0x7A07, 0x67DB, 0xC51D, 0x00AE,
	0xD141, 0x680D, 0x3A32, 0x76DA,
	0x6DEF, 0x759F, 0xBB14, 0xA902,
	0x328C, 0x0625, 0xB5A3, 0x2C6F,};
u8  p[TEXT_SIZE] = { 0, 0, 0x12, 0x34, 0x56, 0x78, 0x9A, 0xBC};	
u8  nonce[TEXT_SIZE] = { 0, 0, 0x12, 0x34, 0x56, 0x78, 0x9A, 0xBC};	
extern void PRESENT_enc(u8* p, u16* rk);
extern void PRESENT_enc_ctr(u8* nonce, u16* rk, u8* p, u16* pre_compute);
extern void PRESENT_gen(u8* p, u16* rk, u16* pre_compute);

int main(void)
{
	//PRESENT_enc(p,rk);
	PRESENT_gen(p,rk,pre_compute);
	
	
   PRESENT_enc_ctr(nonce,rk,p,pre_compute);
}

